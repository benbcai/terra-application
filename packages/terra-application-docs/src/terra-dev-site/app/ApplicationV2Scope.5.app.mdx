# terra-application v2.0 Scope

## Statement of Intent

terra-application v2.0 will further define the architecture, design, and capabilities of Terra
web applications.

### Features

* Application Composition, Defined
  * Each tier of the framework componentry will have a defined role and expectation for usage.
  * Applications will be able to be stood up and composed very quickly with off-the-shelf components.
* Application Navigation, Defined
  * Primary and secondary navigation patterns will be created and provided to consumers with consumer-friendly APIs.
  * Navigation components will utilize Portals to minimize component refreshes/re-mountings.
  * First-class support for embedded applications without navigation will also be included.
* Pages, Defined
  * Explicit components for page-level content navigation will be provided.
  * Pages will also support the progressive disclosure of additional pages to allow nested workflows to exist within the same navigation endpoint.
* Notifications, Kinda Defined
  * Components are provided to simplify the presentation and handling of user notifications.
* An Improved Vocabulary
  * A new lexicon better describes the intentions and responsibilities of different classes of components.
  * These definitions allow us to communicate consistently and easily identify areas of reuse and composition.
  * Narrowing the language in this way will also improve our ability to support the consumer base.
* Consumer Quality of Life Updates
  * Components like Modals that have historically been hard to work with have been enhanced to better meet consumer expectations.
  * New components have been created to better support existing workflows without custom consumer work.
* Updated Dependencies
  * Framework dependencies were updated to provide our consumers with up to date enhancements and fixes.

## Projects

### Application Concept Context

#### Description

An optional, application-level provider of UI components and data APIs for application concept data. Framework components
will read from this context to render appropriate UI banners within the application and ensure said content is visible
throughout modal workflows.

This will further reduce the custom logic implemented by orion-clinical-application and will provide a consistent, agnostic
API for global concept data communication. 

#### New Components

* ApplicationConceptProvider

#### Project Dependencies

* N/A

#### Project Consumers

* ApplicationContainer
* Modal

#### Outstanding Questions

* Final API
  * Separate interfaces for page-level/modal-level content
  * A generic key/value store for concept data

### Navigation Architecture

#### Description

A collection of components that compose terra-application's page-level architecture. These components
enforce accessibility conventions and provide high-level APIs for navigation patterns within Terra applications.

Required composition would roughly look like:

ApplicationBase
  ApplicationContainer
    ApplicationNavigation
      NavigationItem
        Page
      NavigationItem
        Page

* ApplicationBase
  * 1 per application endpoint
  * API only, no UI, no DOM (ideally)
  * i18n/theme/breakpoint/anything else useful
* ApplicationContainer
  * 1 per application endpoint
  * Will implement ApplicationConceptContext to render concept UI
  * Will implement LayerManager to orchestrate modal/dialog/overlay presentation
  * Variants can exist for other embedded platforms/integrations
* ApplicationNavigation
  * 1 per application endpoint
  * Will utilize NavigationItem's as children by default
  * Variants can exist for different UX implementations
* Page
  * 1 visible at any given time
  * Page content must be display block and overflow the provided Container
  * Layouts for Page content may be additionally provided

### Routing/Deep-Linking Navigation Design

#### Description

The framework needs to stake ownership of (or provide guidelines for or against) a general routing strategy
for deep-linking to content within an application.

#### New Components

* TBD

#### Updated Components

* TBD

#### Project Dependencies

* ApplicationContainer
* PageContainer

#### Outstanding Questions

Issues are present with the usage of pushState for in-page routing with stateful applications. A system to
interrupt, prevent, and confirm those navigation would need to be developed for users of browser controls. An example
would be the dismissing a modal because the user navigated away from the content that presented it. If we leave it open,
the user loses the original modal's presentation context. If we dismiss it, any dirty state in the modal could be lost
inadvertently.

Issues are also present with the usage of replaceState to not create additional history entries. Users expect to be
able to navigate using browser controls if they see the URL changing.

Alternatives include:

* Using sessionStorage + "Share Links" to build query-param-based payloads to initialize application state
* Using query params all the time
* Doing the legwork to make browser navigation work

---

### Declarative Modal

#### Description

An updated Modal component that utilizes a simplified declarative API to promote ease of use for consumers.
Includes improved a11y patterns and Page integration.

Content within the Modal must have the same capabilities and constraints as Page content.

#### New Components

* Modal

---

### Blocking Overlay

#### Description

A new Overlay component used to completely prevent user interaction during sensitive workflows, typically
while waiting for async responses.

Needs to cover all presentation layers (base, modal, popup, notification dialog) except framework dialog.

#### New Components

* Blocking Overlay

#### Updated Components

* N/A

#### Project Dependencies

* N/A

#### Outstanding Questions

* Final UX Input
  * Timeout logic to minimize flashing
* Need to decide on declarative vs. imperative API

---

### Notification Handling

#### Description

A collection of components integrated with the overall framework to present notifications to the user.

Notification styles include:

* Banner
* Dialog
* Toast (?)

#### New Components

* Toast

#### Updated Components

* NotificationDialog
* Alert

#### Project Dependencies

* Page

#### Outstanding Questions

* Need to determine how to manage multiple presented dialogs
  * Imperative vs. declarative API

---

### Application Splash Page

#### Description

A visually pleasing view presented to the user upon initial application load. 
This presentation\will precede user login/initial app load.

#### New Components

* TBD

#### Updated Components

* TBD

#### Project Consumers

* ApplicationContainer

#### Outstanding Questions

* Presentation
  * Baked into the rails/static template vs. React-based vs. combination of both (most likely)
  * Dynamic based on theme vs. static
  * Deferred presentation to limit flickering/a11y problems
* Design Input

---

### Framework Dialog

#### Description

A specialized dialog used only by the framework to present dialogs on top of all other application content.

First use case is pending session locks.

#### New Components

* FrameworkDialog

#### Updated Components

* N/A

#### Project Dependencies

* N/A

#### Outstanding Questions

* Need to figure out how to present dialogs on top of dialogs, inerting along the way
* Design input

---

### react-intl Uplift

#### Description

Need to get up to date for react-intl.

#### New Components

* N/A

#### Updated Components

* N/A

#### Project Dependencies

* Lots

#### Outstanding Questions

* Can we get away with opening up the version to support v2/3/4
  * Duplicate package checker would prevent dupes